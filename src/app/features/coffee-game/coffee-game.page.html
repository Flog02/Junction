<!-- src/app/features/coffee-game/coffee-game.page.html -->
<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Barista Challenge</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="resetGame()">
        <ion-icon name="refresh-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="game-wrapper">
    <div class="game-stats-bar">
      <div class="stat-item">
        <div class="stat-label">Score</div>
        <div class="stat-value">{{ gameScore }}</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">High Score</div>
        <div class="stat-value">{{ highScore }}</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">Games</div>
        <div class="stat-value">{{ completedGames }}</div>
      </div>
    </div>
    
    <div class="game-container" #gameContainer>
      <!-- The React game component will be mounted here -->
      <div id="coffee-game-root"></div>
      
      <!-- Loading state -->
      <div *ngIf="isLoading" class="loading-overlay">
        <ion-spinner name="crescent"></ion-spinner>
        <p>Loading Barista Challenge...</p>
      </div>
      
      <!-- Game canvas - This is what was missing! -->
      <canvas *ngIf="!isLoading" id="coffee-game-canvas" width="800" height="600"></canvas>
    </div>
    
    <div class="game-instructions">
      <h2>How to Play</h2>
      <p>Take on the role of a barista and create the perfect coffee drinks based on customer orders!</p>
      <ul>
        <li>Select an order from the list to start making it</li>
        <li>Control the grinding, temperature, and milk levels</li>
        <li>Try to match the target values for each parameter</li>
        <li>Complete as many orders as possible to earn points</li>
        <li>Earn loyalty points based on your score!</li>
      </ul>
    </div>
    
    <!-- Game controls for mobile -->
    <div class="game-controls" *ngIf="!isLoading">
      <div class="control-group">
        <h3>Grind Control</h3>
        <ion-range min="0" max="100" [(ngModel)]="grindLevel" (ionChange)="onGrindChange($event)">
          <ion-icon slot="start" name="cafe-outline"></ion-icon>
          <ion-icon slot="end" name="cafe"></ion-icon>
        </ion-range>
      </div>
      
      <div class="control-group">
        <h3>Temperature</h3>
        <ion-range min="65" max="100" [(ngModel)]="tempLevel" (ionChange)="onTempChange($event)">
          <ion-icon slot="start" name="thermometer-outline"></ion-icon>
          <ion-icon slot="end" name="thermometer"></ion-icon>
        </ion-range>
      </div>
      
      <div class="control-group">
        <h3>Milk Froth</h3>
        <ion-range min="0" max="100" [(ngModel)]="milkLevel" (ionChange)="onMilkChange($event)">
          <ion-icon slot="start" name="water-outline"></ion-icon>
          <ion-icon slot="end" name="water"></ion-icon>
        </ion-range>
      </div>
      
      <ion-button expand="block" class="serve-button" (click)="serveDrink()">
        Serve Drink
        <ion-icon name="checkmark-circle-outline" slot="end"></ion-icon>
      </ion-button>
    </div>
  </div>
</ion-content>